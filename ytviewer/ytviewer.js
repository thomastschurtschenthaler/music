!async function(){if(window.YTViewer_Player=function(){let e=document.createElement("div");e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.width="auto",e.style.height="auto",e.style.zIndex="10000",e.style.backgroundColor="rgba(0, 0, 0, 0.3)";let t=document.createElement("div");t.style.position="absolute",t.style.top="10px",t.style.left="10px",t.style.width="8rem",t.style.height="1.8rem",t.style.fontSize="1.5rem",t.style.backgroundColor="#33aa33",t.style.color="#eeeeee",t.style.paddingLeft="1rem",t.style.cursor="pointer",t.style.borderRadius="1rem",t.innerHTML="YTViewer",t.addEventListener("click",(e=>{if(window.location.href.indexOf("?")>=0){let e=new URLSearchParams(window.location.href.substring(window.location.href.lastIndexOf("?")+1)).get("v");if(null!=e)return void window._ytviewer.play(e)}alert("YTViewer - click on a youtube thumbnail to play the video.\n\nAuthor: Thomas Tschurtschenthaler")})),e.appendChild(t),document.body.appendChild(e);let i=null,l=null,n=null,o=()=>{null!=i&&(e.removeChild(i),e.removeChild(l),e.style.width="auto",e.style.height="auto",t.style.display="inline",i=null,l=null,n=null)};return{isplaying:e=>e==n,play:async(r,s)=>{if(o(),null==s){let t=null;try{t=await ytdl.getInfo(r,{})}catch(t){return void(e.innerHTML="Error:"+t)}console.log("videoInfo",t);let i=t.formats.filter((e=>e.hasAudio&&e.hasVideo)),l=["144p","240p","360p","480p","720p","1080p","1440p","2160p","4320p"];i.sort(((e,t)=>{let i=l.indexOf(e.qualityLabel);return l.indexOf(t.qualityLabel)-i})),console.log("formatvideo",i),s=i[0].url}n=r,e.style.width="100%",e.style.height="100%",t.style.display="none",i=document.createElement("video"),i.setAttribute("controls","true"),i.setAttribute("width","80%"),i.setAttribute("height","80%"),i.style.marginLeft="10%",i.style.marginTop="5%";let d=document.createElement("source");d.setAttribute("src",s),d.setAttribute("type","video/mp4"),i.appendChild(d),e.appendChild(i),i.load(),i.play(),l=document.createElement("div"),l.style.position="absolute",l.style.top="10px",l.style.left="10px",l.style.width="10rem",l.style.height="1.8rem",e.appendChild(l);let a=document.createElement("div");a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.width="2.4rem",a.style.height="1.8rem",a.style.fontSize="1.5rem",a.style.backgroundColor="#aa3333",a.style.color="#eeeeee",a.style.cursor="pointer",a.style.borderRadius="1rem",a.innerHTML="<div style='padding-left:0.7rem'>X</div>",a.addEventListener("click",(e=>{o()})),l.appendChild(a),mini=document.createElement("div"),mini.style.position="absolute",mini.style.top="0px",mini.style.left="3rem",mini.style.width="2.4rem",mini.style.height="1.8rem",mini.style.fontSize="1.5rem",mini.style.backgroundColor="#aa8822",mini.style.color="#eeeeee",mini.style.cursor="pointer",mini.style.borderRadius="1rem",mini.innerHTML="<div style='padding-left:0.6rem'>—</div>";let y=!1;mini.addEventListener("click",(t=>{y?(mini.innerHTML="<div style='padding-left:0.6rem'>—</div>",e.style.width="100%",e.style.height="100%",i.style.display="inline"):(mini.innerHTML="<div style='padding-left:0.4rem; padding-top:-0.2rem;'>＋</div>",e.style.width="auto",e.style.height="auto",i.style.display="none"),y=!y})),l.appendChild(mini)}}},window.location.host.indexOf("youtube.com")<0)alert("Use YTViewer on Youtube pages www.youtube.com or m.youtube.com.");else if(null==window._ytviewer&&(null!=document.body&&document.body.addEventListener("click",(async e=>{if(e.target.closest('a[href^="/watch?"]')||e.target.closest("ytd-thumbnail")){let t=e.target.closest('a[href^="/watch?"]').href;console.log("videoLink",t);let i=new URLSearchParams(t.substring(t.lastIndexOf("?")+1)).get("v");if(console.log("videoid",i),window._ytviewer.isplaying(i))return;e.preventDefault(),e.stopPropagation(),window._ytviewer.play(i)}}),!0),window._ytviewer=window.YTViewer_Player(),console.log("ytviewer started")),window.location.href.indexOf("?")>=0){let e=new URLSearchParams(window.location.href.substring(window.location.href.lastIndexOf("?")+1)).get("v");null!=e&&window._ytviewer.play(e)}}();